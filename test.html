<!doctype html public "-//w3c//dtd xhtml 1.0 transitional//en">
<html>
<head>
    <title>EditTable</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="author" content="">
    <meta name="keywords" content="">
    <script language="javascript" type="text/javascript" src="js/jquery-1.12.0.min.js"></script>
    <style>
        th{
            text-align: center;
        }
        td{
            text-align: center;
        }
    </style>
</head>

<body>
<table class="edtitable" border="1" cellspacing="0.1">
    <thead>
    <tr>
        <td colspan="10" ><center>天安财险股份有限公司</center></td>


    </tr><br>
    <tr>
        <td colspan="10"><center>TIANAN PROPERTY INSURANCE COMPANY</center></td></tr><br>
    <tr>
        <td colspan="10"><center>货物起运申报单</center></td></tr><br>
    <tr>
        <td colspan="10"><center>Cargo Declaration Form</center></td></tr><br>
    <tr>
        <td>投保人(Applicant)</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>

    </tr>
    <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td>填报日期（date）</td>
        <td></td>
        <td></td>
    </thead>
    <tbody>
    <tr>
        <th>航空运单号</th>
        <th>航班号</th>
        <th>起运日期</th>
        <th>起运地</th>
        <th>目的地</th>
        <th>宠物猫（只）</th>
        <th>宠物狗（只）</th>
        <th>宠物价值(CNY)</th>
        <th>保险金额（CNY）</th>
        <th>备注</th>
        <th class="del-col">操作</th>
    </tr>
    <tr>
        <td></td>
        <td>JH5291</td>
        <td>2018/4/7上午12:00:00</td>
        <td>沈阳</td>
        <td>广州</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td class="del-col">
            <a href="javascript:void(0);" class="delBtn">删除</a>
        </td>
    </tr>
    <tr>
        <td></td>
        <td>JH5291</td>
        <td>2018/4/7上午12:00:00</td>
        <td>沈阳</td>
        <td>广州</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td class="del-col">
            <a href="javascript:void(0);" class="delBtn">删除</a>
        </td>
    </tr>
    <tr>
        <td>合计</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td class="del-col noExl">
            <a href="javascript:void(0);" class="delBtn">删除</a>
        </td>
    </tr>
    <tr>
        <td>合计</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr class="append-row noExl">
        <td colspan="7" align="right">
            <input type="button" id="addBtn" value="添 加" />
        </td>
    </tr>
    </tbody>
</table>

</body>
<script>
    //需要首先通过Jq来解决内容部分奇偶行的背景色不同
    //$(document).ready(function(){
        //找到表格的内容区域中所有的奇数行
        //使用even是为了把通过tbody tr返回的所有tr元素中，
        //在数组里面下标是偶数的元素返回，因为这些元素，
        //实际上才是我们期望的tbody里面的奇数行
        //$("tbody tr:odd").css("background-color","#EEEEEE");
        trEdit();//td的点击事件封装成一个函数
    //});

    /*下面兩段开始添加删除行**/
    $(document).ready(function() {
        $("#addBtn").bind("click", function(){
            $("<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td class='del-col noExl'><a href='javascript:void(0);' class='delBtn'>删除</a></td></tr>").insertBefore(".append-row");
            trEdit();
            delTr();
            //$("tbody tr:odd").css("background-color","#EEEEEE");
        });
        delTr();
    });

    //删除
    function delTr(){
        $(".delBtn").click(function(){
            $(this).parent().parent().remove();
        });
    }
    /*
     function even(){
     $("tbody tr:even").css("background-color","#ECE9D8");
     }*/


    //我们需要找到所有的单元格
    function trEdit(){
        var numTd = $("tbody td").not(".del-col");
        //给这些单元格注册鼠标点击的事件
        numTd.click(function() {
            //找到当前鼠标点击的td,this对应的就是响应了click的那个td
            var tdObj = $(this);
            if (tdObj.children("input").length > 0) {
                //当前td中input，不执行click处理
                return false;
            }
            var text = tdObj.html();
            //清空td中的内容
            tdObj.html("");
            var tdHei=tdObj.height()-2;
            //创建一个文本框
            //去掉文本框的边框
            //设置文本框中的文字字体大小是16px
            //使文本框的宽度和td的宽度相同
            //设置文本框的背景色
            //需要将当前td中的内容放到文本框中
            //将文本框插入到td中
            var inputObj = $("<input type='text'>").css({"border":"0","font-family":"Microsoft YaHei","width":"100%","height":"40px","font-size":"16px","text-align":"center"})
                .width(tdObj.width())
                .height(tdHei)
                .css("background-color",tdObj.css("background-color"))
                .val(text).appendTo(tdObj);
            //是文本框插入之后就被选中
            inputObj.trigger("focus").trigger("select");
            inputObj.click(function() {
                return false;
            });
            //处理文本框上回车和esc按键的操作
            inputObj.keyup(function(event){
                //获取当前按下键盘的键值
                var keycode = event.which;
                //处理回车的情况
                if (keycode == 13) {
                    //获取当当前文本框中的内容
                    var inputtext = $(this).val();
                    //将td的内容修改成文本框中的内容
                    tdObj.html(inputtext);
                }
                //处理esc的情况
                if (keycode == 27) {
                    //将td中的内容还原成text
                    tdObj.html(text);
                }
            });
        });
    }

</script>
<button id="btn">导出</button>

<script src="js/jquery-1.12.0.min.js" type="text/javascript" charset="utf-8"></script>//引入jquery
<script src="js/jquery.table2excel.js" type="text/javascript" charset="utf-8"></script> //引入jquer插件
<script type="text/javascript">
    $("#btn").click(function(){ //点击按钮执行导出
        $(".edtitable").table2excel({ //选取导出的表格
            exclude: ".noExl", //写你不想都想导出的
            name: "Excel Document Name.xls",
            filename: "项目.xls", //导出的文件名
            exclude_img: true, //是否导出图片
            exclude_links: true,
            exclude_inputs: true
        });
    })
</script>

</body>
</html>